@page "/images/create/{ownerTypeName}/{ownerId:int}"
@rendermode InteractiveServer

<PageTitle>Adaugă Imagine</PageTitle>

<div class="page-header">
    <h1>Adaugă Imagine</h1>
</div>

<div class="form-container">
    <EditForm Model="@image"
              OnValidSubmit="@HandleValidSubmit"
              FormName="CreateImageForm">

        <DataAnnotationsValidator />

        <!-- File input -->
        <div class="form-group">
            <label>Selectează imagine *</label>
            <InputFile OnChange="OnFileSelected"
                       accept="image/*"
                       class="form-control" />

            @if (!string.IsNullOrEmpty(fileError))
            {
                <div class="validation-message">@fileError</div>
            }
        </div>

        <!-- Preview -->
        @if (!string.IsNullOrEmpty(previewUrl))
        {
            <div class="form-group">
                <label>Previzualizare</label>
                <img src="@previewUrl"
                     style="max-width:300px; border-radius:6px;" />
            </div>
        }

        <!-- Alt text -->
        <div class="form-group">
            <label>Text alternativ</label>
            <InputText @bind-Value="image.AltText"
                       class="form-control" />
        </div>

        <!-- Primary -->
        <div class="form-group">
            <label>
                <InputCheckbox @bind-Value="image.IsPrimary" />
                Imagine principală
            </label>
        </div>

        <!-- Actions -->
        <div class="form-actions">
            <button type="submit"
                    class="btn btn-primary"
                    disabled="@(selectedFile == null || isUploading)">
                @(isUploading ? "Se încarcă..." : "Salvează")
            </button>

            <button type="button"
                    class="btn btn-secondary"
                    @onclick="Cancel">
                Anulează
            </button>
        </div>

        @if (!string.IsNullOrEmpty(errorMessage))
        {
            <div class="alert alert-danger">@errorMessage</div>
        }
    </EditForm>
</div>
